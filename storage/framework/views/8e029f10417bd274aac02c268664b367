<?php $__env->startSection('content'); ?>
<div id="subject">
    <div id="main">
        <div class="look_charge_details_comment">
            <form class="lcdc_form">
                <input type="hidden" name="id" id="id" value="<?php echo e($course->id); ?>">
                <div class="lcdc_title">输入评论</div>
                <div class="lcdc_textarea"><textarea id="lcdc_textarea" name="content" placeholder="不少于20字符。"></textarea></div>
                <div class="lcdc_button"><input class="lcdc_form_button" type="submit" value="提交"></div>
            </form>
        </div>
    </div>
</div>
<?php $__env->stopSection(); ?>

<?php $__env->startSection('script'); ?>
<script type="text/javascript">
    $(document).ready(function(){
        $(".lcdc_form_button").click(function(){//提交评论
            if($("#lcdc_textarea").val().length<20){
                Popup.init({
                    popTitle:'提交失败',
                    popHtml:'<p>您输入的评论信息不能少于20个字符</p>',
                    popFlash:{
                        flashSwitch:true,
                        flashTime:1000,
                    }
                });
                return false;
            }

            var id = $('#id').val();
            var content = $('#lcdc_textarea').val();
            $.ajax({
                type: 'post',
                url: '<?php echo e(route('course.do_comment')); ?>',
                data: {id: id,content: content},
                success: function (res) {
                    if (res.code == 0) {
                        //ajax成功返回事件开始
                        Popup.init({
                            popTitle:'评论成功',
                            popHtml:'<p>'+res.message+'</p>',
                            popFlash:{
                                flashSwitch:true,
                                flashTime:3000,
                            }
                        });
                        window.location.href='<?php echo e(route('course.detail',['id'=>$course->id])); ?>';
                        //ajax成功返回事件结束
                    } else {
                        Popup.init({
                            popTitle:'评论失败',
                            popHtml:'<p>'+res.message+'</p>',
                            popFlash:{
                                flashSwitch:true,
                                flashTime:3000,
                            }
                        });
                    }
                }
            });
            /*----------ajax开始----------*/
                //ajax成功返回事件开始
                    //返回成功后应跳转页面
                //ajax成功返回事件结束
            /*----------ajax结束----------*/
            return false;
        });
    });
</script>

<?php $__env->stopSection(); ?>

<?php echo $__env->make('layout.default', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>